# 86. Алгоритм метода проекции градиента Розена для задач с линейными ограничениями

## Постановка задачи
Минимизировать $ f(x) $ при условиях:  
$
\begin{cases}
Ax \leq b \\
Hx = d
\end{cases}
$

## Подготовительный этап
1. Выбираем начальную допустимую точку $ x^1 $, удовлетворяющую:  
   $ Ax^1 \leq b, \quad Hx^1 = d $
2. Разделяем матрицу ограничений:  
   $ A = \begin{pmatrix} A_1 \\ A_2 \end{pmatrix}, \quad b = \begin{pmatrix} b^1 \\ b^2 \end{pmatrix} $
   где:  

   - $ A_1x^1 = b^1 $ (активные ограничения)
   - $ A_2x^1 < b^2 $ (неактивные ограничения)
3. Полагаем $ k = 1 $

## Основной этап

### Шаг 1: Определение направления спуска
1. Формируем матрицу активных ограничений:
   $ M = \begin{pmatrix} A_1 \\ H \end{pmatrix} $

2. Вычисляем проекционную матрицу:  
   $$
   P = \begin{cases}
   I, & \text{если } M \text{ пуста} \\
   I - M^T(MM^T)^{-1}M, & \text{иначе}
   \end{cases}
   $$

3. Находим направление спуска:  
   $ S^k = -P\nabla f(x^k) $

4. Проверяем направление:
   - Если $ S^k \neq 0 $ → переход к Шагу 2
   - Если $ S^k = 0 $:
     - При пустой $ M $ → останов (оптимум достигнут)
     - Иначе вычисляем множители Лагранжа:  
       $ \omega = -(MM^T)^{-1}M\nabla f(x) = \begin{pmatrix} u \\ v \end{pmatrix} $
       - Если $ u \geq 0 $ → останов (точка Куна-Таккера)
       - Иначе исключаем ограничение с отрицательным $ u_j $ и повторяем Шаг 1

### Шаг 2: Одномерная оптимизация
Решаем задачу:
$$ \min_{0 \leq \alpha \leq \alpha_{\max}} f(x^k + \alpha S^k) $$

где $ \alpha_{\max} $ вычисляется как:
$$
\alpha_{\max} = 
\begin{cases} 
\min \left\{ \frac{\tilde{b}_i}{\tilde{s}_i} : \tilde{s}_i > 0 \right\}, & \text{если } \exists \tilde{s}_i > 0 \\
\infty, & \text{если } \tilde{s}_i \leq 0 \ \forall i
\end{cases}
$$
с параметрами:  
$ \tilde{b} = b^2 - A_2x^k, \quad \tilde{s} = A_2S^k $

### Шаг 3: Обновление точки  
$ x^{k+1} = x^k + \alpha_k S^k $  
$ k = k + 1 $

## Блок-схема алгоритма
```mermaid
graph TD
    A[Начальная точка x¹] --> B[Определение активных ограничений]
    B --> C[Построение матрицы P]
    C --> D{Проверка S = 0?}
    D -->|Нет| E[Линейный поиск]
    D -->|Да| F{Проверка u ≥ 0?}
    F -->|Да| G[СТОП: точка Куна-Таккера]
    F -->|Нет| H[Исключение ограничения]
    H --> B
    E --> I[Обновление точки]
    I --> B